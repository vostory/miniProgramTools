<view class="converter-page" data-theme="{{theme}}">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="custom-nav">
    <button class="back-btn" bindtap="goBack">â†</button>
    <!-- <text class="nav-title">å•ä½æ¢ç®—</text> -->
    <button class="home-btn" bindtap="goHome">ğŸ </button>
  </view>

  <!-- æ¢ç®—ç±»å‹é€‰æ‹© -->
  <scroll-view class="category-scroll" scroll-x>
    <view class="category-container">
      <view 
        class="category-item {{currentCategory === item.id ? 'active' : ''}}" 
        wx:for="{{categories}}" 
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="selectCategory"
      >
        <text class="category-icon">{{item.icon}}</text>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </scroll-view>

  <!-- ä¸»æ¢ç®—åŒºåŸŸ -->
  <view class="converter-main">
    <!-- è¾“å…¥åŒºåŸŸ -->
    <view class="converter-section">
      <view class="input-group">
        <view class="input-header">
          <text class="input-label">è¾“å…¥</text>
        </view>
        <input 
          class="input-field" 
          type="number" 
          placeholder="0" 
          value="{{fromValue}}" 
          bindinput="onFromValueChange"
        />
        <picker 
          class="unit-picker" 
          range="{{fromUnits}}" 
          range-key="name" 
          value="{{fromUnitIndex}}" 
          bindchange="onFromUnitChange"
        >
          <view class="unit-display">
            <text class="unit-text">{{fromUnits[fromUnitIndex].name}}</text>
            <text class="unit-arrow">â–¼</text>
          </view>
        </picker>
      </view>

      <!-- è½¬æ¢æŒ‰é’®ï¼ˆå»é™¤äº†æ¤­åœ†èƒŒæ™¯ï¼‰ -->
      <view class="swap-container">
        <button class="swap-btn" bindtap="swapUnits">
          <text class="swap-icon">â†”</text>
        </button>
      </view>

      <!-- è¾“å‡ºåŒºåŸŸ -->
      <view class="input-group">
        <view class="input-header">
          <text class="input-label">è¾“å‡º</text>
        </view>
        <input 
          class="input-field" 
          type="text" 
          placeholder="0" 
          value="{{toValue}}" 
          disabled
        />
        <picker 
          class="unit-picker" 
          range="{{toUnits}}" 
          range-key="name" 
          value="{{toUnitIndex}}" 
          bindchange="onToUnitChange"
        >
          <view class="unit-display">
            <text class="unit-text">{{toUnits[toUnitIndex].name}}</text>
            <text class="unit-arrow">â–¼</text>
          </view>
        </picker>
      </view>
    </view>

    <!-- æ¢ç®—å…¬å¼æ˜¾ç¤º -->
    <view class="formula-section" wx:if="{{formula}}">
      <text class="formula-text">{{formula}}</text>
    </view>

    <!-- å¸¸ç”¨å•ä½å¿«é€Ÿé€‰æ‹© -->
    <view class="quick-section" wx:if="{{quickUnits.length > 0}}">
      <text class="section-title">å¸¸ç”¨å•ä½</text>
      <view class="quick-grid">
        <button 
          class="quick-btn" 
          wx:for="{{quickUnits}}" 
          wx:key="index"
          data-unit="{{item.unit}}"
          data-type="{{item.type}}"
          bindtap="quickSelectUnit"
        >
          <text class="quick-text">{{item.name}}</text>
        </button>
      </view>
    </view>

    <!-- å¸¸ç”¨æ¢ç®— -->
    <view class="common-section" wx:if="{{commonConversions.length > 0}}">
      <text class="section-title">å¸¸ç”¨æ¢ç®—</text>
      <view class="common-list">
        <view 
          class="common-item" 
          wx:for="{{commonConversions}}" 
          wx:key="index"
          bindtap="useCommonConversion"
          data-index="{{index}}"
        >
          <view class="common-left">
            <text class="common-value">{{item.value}}</text>
            <text class="common-unit">{{item.fromUnit}}</text>
          </view>
          <text class="common-equals">=</text>
          <view class="common-right">
            <text class="common-result">{{item.result}}</text>
            <text class="common-unit">{{item.toUnit}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½• -->
  <view class="history-section" wx:if="{{history.length > 0}}">
    <view class="section-header">
      <text class="section-title">æ¢ç®—å†å²</text>
      <button class="clear-btn" bindtap="clearHistory">æ¸…ç©º</button>
    </view>
    <scroll-view class="history-list" scroll-y>
      <view class="history-item" wx:for="{{history}}" wx:key="index">
        <view class="history-content">
          <text class="history-expr">{{item.data.expression}}</text>
          <text class="history-result">{{item.data.result}}</text>
        </view>
        <text class="history-time">{{item.time}}</text>
      </view>
    </scroll-view>
  </view>
</view>